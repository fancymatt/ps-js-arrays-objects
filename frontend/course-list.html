<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Course List - Globomantics Company Onboarding</title>
        <link rel="stylesheet" href="reset.css">
        <link rel="stylesheet" href="styles.css">
    </head>
    <body>
        <header class="header">
            <nav class="main-nav">
                <ul>
                    <li><a href="course-list.html">Course List</a></li>
                    <li><a href="notebook.html">Your Notebook</a></li>
                </ul>
            </nav>
            <nav class="admin-nav">
                <ul>
                    <li><a href="admin-course-list.html">Admin</a></li>
                </ul>
            </nav>
        </header>
        <div class="title"><h1>Globomantics Company Onboarding</h1></div>
        <div class="course-list">
            <ul id="course-list-root">

            </ul>
        </div> 

        <template id="courseArticle">
            <li>
                <h2 id="courseTitle">Title</h2>
                <a id="studyCourseLink" href="#" class="button primary">Study Now</a>
            </li>
        </template>

    </body>

    <script src="shared.js"></script>
    <script>
        const courseListRoot = document.getElementById("course-list-root");

        const onLoadCourses = function() {
            updateCourseListDisplay();
        }

        const fetchCourses = async function() {
            if (courses == null) {
                fetch('http://localhost:8000/api/courses')
                    .then(response => response.json())
                    .then(json => {
                        parseCourseListJsonAsCourseList(json.courses);
                        onLoadCourses();
                    });
            } else {
                onLoadCourses();
            }
        };

        const updateCourseListDisplay = function() {
            courses.forEach(course => {
                let courseArticle = document.getElementById("courseArticle").content.cloneNode(true);
                courseArticle.getElementById("courseTitle").innerHTML = course.title;
                courseArticle.getElementById("studyCourseLink").href = "study.html?" + course.id;
                courseListRoot.appendChild(courseArticle);
            });
        };

        fetchCourses();
    </script>
</html>